# Cáº¥u hÃ¬nh cho mÃ´i trÆ°á»ng QA cá»§a User Service
server:
  port: 8700

spring:
  # CÃ¡c thÃ´ng tin káº¿t ná»‘i nÃ y sáº½ Ä‘Æ°á»£c cung cáº¥p qua biáº¿n mÃ´i trÆ°á»ng trong docker-compose.yml
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka:29092}
  datasource:
    # Sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng Ä‘á»ƒ káº¿t ná»‘i DB, cÃ³ giÃ¡ trá»‹ máº·c Ä‘á»‹nh dá»± phÃ²ng
    url: jdbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/${DB_NAME:user_service}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    database-platform: org.hibernate.dialect.PostgreSQLDialect
  cloud:
    stream:
      bindings:
        my-input-0:
          destination: high-throughput-topic
          group: high-throughput-group
          consumer:
            # Báº­t cháº¿ Ä‘á»™ nháº­n message theo batch thay vÃ¬ tá»«ng cÃ¡i má»™t
            # Cáº£i thiá»‡n hiá»‡u nÄƒng Ä‘Ã¡ng ká»ƒ
            batch-mode: true
            # TÄƒng sá»‘ luá»“ng xá»­ lÃ½ trÃªn Má»˜T instance cá»§a microservice
            # VÃ­ dá»¥, náº¿u topic cÃ³ 50 partitions vÃ  báº¡n cháº¡y 5 instances, má»—i instance
            # sáº½ xá»­ lÃ½ 10 partitions. concurrency=10 sáº½ táº¡o 10 luá»“ng Ä‘á»ƒ xá»­ lÃ½ 10 partition Ä‘Ã³
            concurrency: 10
      kafka:
        binder:
          brokers: broker1:9092,broker2:9092,broker3:9092
        bindings:
          my-input-0:
            consumer:
              configuration:
                # TÄƒng sá»‘ lÆ°á»£ng record tá»‘i Ä‘a consumer láº¥y vá» trong má»™t láº§n poll
                max.poll.records: 500
                # Tá»± Ä‘á»™ng commit offset bá»‹ vÃ´ hiá»‡u hÃ³a khi dÃ¹ng batch-mode
                # Báº¡n cáº§n xá»­ lÃ½ commit offset thá»§ cÃ´ng hoáº·c dÃ¹ng AckMode.BATCH
                auto-commit-offset: false
                # TÄƒng kÃ­ch thÆ°á»›c dá»¯ liá»‡u tá»‘i thiá»ƒu consumer muá»‘n láº¥y vá»
                fetch.min.bytes: 1048576 # 1MB
                # Thá»i gian tá»‘i Ä‘a consumer chá» Ä‘á»ƒ gom Ä‘á»§ fetch.min.bytes
                fetch.max.wait.ms: 500
# TÃªn á»©ng dá»¥ng Ä‘á»ƒ Ä‘Äƒng kÃ½ vá»›i Eureka
eureka:
  instance:
    hostname: user-service
  client:
    register-with-eureka: true
    fetch-registry: true
    # service-url Ä‘Ã£ Ä‘Æ°á»£c cung cáº¥p qua biáº¿n mÃ´i trÆ°á»ng trong docker-compose.yml

# CÃ¡c cáº¥u hÃ¬nh khÃ¡c giá»¯ nguyÃªn
management:
  endpoints:
    web:
      exposure:
        include: "*"

app:
  message: "ÄÃ¢y lÃ  cáº¥u hÃ¬nh cho User-Service mÃ´i trÆ°á»ng QA! ğŸ‰"